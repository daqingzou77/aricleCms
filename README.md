# aricleCms
支持隐私保护外包文件多关键词检索的文章信息管理系统

<!-- 具有隐私保护的轻量级外包文件多关键词检索方法及系统 -->

==== 详细步骤 ====

S01 --- 获取系统安全参数和抗碰撞哈希函数生成公开参数
----
在系统初始化模块1中输入多个系统安全参数λ1、λ2、λ3、λ4 ，并随机选取一个长度为第二个系统安全参数λ2位的第一大素数p和一种抗碰撞哈希函数H生成系统公开参数，公开参数为（λ1、λ2、λ3、λ4、p、H ），其中，抗碰撞哈希函数H为一种输入任意长度的二进制串，输出为λ1位二进制串，表示方法为{0,1}*->{0,1}λ1  

安全参数 200 512  128 128  
----

S02  --- 系统公开参数生成密钥，并定义关键词词典
----
在用户密钥生成模块2中，从系统公开参数的域Zp中随机选取一个非零元素作为密钥k，n个关键词构成一个关键词词典D
----

S03 --- 对每个外包文件，根据文件内容和关键词词典生成文件索引向量
----
对于在文件处理模块3中的每个外包文件时，构造一个长度大于所述关键词词典D长度的文件索引向量I* ，其长度一般为n+2，然后判断该文件中每个元素的文件索引向量的值I* （1<=i<=n+2 ），若该文件中包含关键词词典的第i（1<=i<=n ）个关键词，则文件索引向量的第i个元素设置为1，即I*i=1 ，若该文件中不包含关键词词典的第i个关键词，则文件索引向量I*的第i个元素设置为0，即I*i=0 ，令I*n+1=0,I*n+2=0。之后，还为外包文件随机选取一个唯一的文件名N，并计算文件大小d和哈希值θ，哈希值θ=H(N||d) ，||表示字符串连接。
----

S04 --- 所述文件索引向量进行加密，得到密文索引向量，上传至服务器
----
具体的，使用密钥k对文件索引向量I*进行加密，得到密文索引向量I^，其中I^=(I^1,I^2,L..,I^n+2) ，对于文件索引向量I^中的每个元素 （1<=i<=n+2 ），随机选取一个长度为第三个系统安全参数λ3位的第一大随机数ai ，计算I^i=k(Ii*O+ai) mod p ，其中，当Ii*=0时，I^i=k*ai mod p ，然后将外包文件及密文索引向量I^上传至云服务器。
----

S05 --- 查询关键词和关键词词典生成查询向量
---
对于每个外包文件在文件查询模块4时，根据查询需求生成查询关键词，并构造一个长度大于所述关键词词典D长度的查询向量Q ，其长度一般为n+2，然后判断该文件中每个元素的查询向量的值 Qi（1<=i<=n+2> ），若该查询关键词中包含关键词词典的第i（1<=i<=2）个关键词，则查询向量Q的第i个元素设置为1，即Qi=1 ，若该查询关键词中不包含关键词词典的第i个关键词，则文件索引向量Q的第i个元素设置为0，即Qi=0 ，令Qn+1=0，Qn+2=0。
---

S06 --- 对所述的查询向量进行加密，得到密文检索陷门
---
使用密钥k对查询向量Q进行加密，得到密文检索陷门Q*，其中Q*=(Q*1, Q*2, L,...Q*n+2) ，对于查询向量Q中的每个元素Qi=（1=<i=<n+2），随机选取一个长度为第一个系统安全参数λ1位的第二大随机数m和随机选取一个长度为第四个系统安全参数λ4位的第三大随机数ci ，计算Q*=（） ，其中，当Qi=0 时，Q*=（） 。
---

S07 --- 将所述密文检索陷门和预设的相似度阀值提交给云服务器
---
具体的，选取预设的相似度阀值t（0<=t<=n），将第二大随机数m、密文检索陷门Q*和相似度阀值t提交给云服务器。
---

S08 --- 计算所述密文检索陷门和所述密文索引向量的相似度，返回相应数据
---
具体的，当服务器响应模块5接收到所述密文检索陷门Q*后，首先对每个外包文件，计算第三中间数值p=... ，然后计算第一中间数值E=.. ，根据第一中间数值E和第三中间数值p计算第二中间数值G，由所述密文检索陷门Q*和所述密文索引向量i*计算相似度I**Q=G/E ，如果I**Q>=t ，则将该文件、文件名N以及相似度I**Q返回给数据拥有者，其中，符号*表示向量内积运算，/表示除法运算
---

=== 系统模块 ===
1.系统初始化模块
2.用户密钥生成模块
3.文件处理模块
4.文件查询模块
5.服务器响应模块

=== 电性连接 ===
1 <---> 2
2 <---> 5
3 <---> 4

=== 综合描述===
所述方法根据系统公开参数生成密钥，多个关键词组成关键词词典，对于每个外包文件，根据文件内容和关键词词典构造文件索引向量，通过密钥对文件索引向量加密处理，得到密文索引向量，然后外包至云服务器，在检索时，根据查询关键词和关键词词典构造查询向量，通过密钥加密变换之后得到密文检索陷门，并预设一相似度阀值，提交至云服务器，使云服务器仅能根据密文形式的密文检索陷门执行数据检索，当根据密文索引向量和密文检索陷门计算出的相似度超过预设的相似度阀值时，将检索到的外包数据返回给用户，提高检索效率，提升弱设备客户端的用户的搜索体验